"use client";

import React, { useState } from "react";
import Link from "next/link";
import { usePathname, useRouter } from "next/navigation";
import PinModal from "../medical-record/[ids]/detail/[id]/_components/PinModal";

const Footer: React.FC = () => {
    const pathname = usePathname();
    const router = useRouter();
    const [isPinModalOpen, setIsPinModalOpen] = useState(false);

    const handleMedicalRecordClick = (e: React.MouseEvent) => {
        e.preventDefault();
        setIsPinModalOpen(true);
    };

    const handlePinSubmit = (pin: string[]) => {
        const enteredPin = pin.join("");
        // Replace with actual pin validation
        if (enteredPin === "123456") {
            setIsPinModalOpen(false);
            router.push("/medical-record");
        } else {
            alert("Invalid PIN");
        }
    };

    return (
        <>
            <div className="fixed bottom-0 left-0 right-0 flex justify-around items-center h-[68px] bg-white p-4 border-t-[1px]">
                <Link
                    href="/home"
                    className={`flex flex-col items-center ${
                        pathname === "/home" ? "text-primary" : "text-black"
                    } hover:text-primary`}
                >
                    <svg
                        width="18"
                        height="19"
                        viewBox="0 0 18 19"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M10.45 0.532953C10.0442 0.190975 9.53065 0.00341797 9 0.00341797C8.46935 0.00341797 7.95577 0.190975 7.55 0.532953L0.8 6.22795C0.549459 6.43911 0.348059 6.70243 0.209877 6.99952C0.0716959 7.29661 6.77287e-05 7.6203 0 7.94795V17.253C0 18.219 0.784 19.003 1.75 19.003H4.75C5.21413 19.003 5.65925 18.8186 5.98744 18.4904C6.31563 18.1622 6.5 17.7171 6.5 17.253V13.25C6.5 12.57 7.042 12.018 7.717 12H10.283C10.6088 12.0086 10.9183 12.144 11.1456 12.3775C11.373 12.611 11.5001 12.9241 11.5 13.25V17.253C11.5 18.219 12.284 19.003 13.25 19.003H16.25C16.7141 19.003 17.1592 18.8186 17.4874 18.4904C17.8156 18.1622 18 17.7171 18 17.253V7.94695C17.9999 7.6193 17.9283 7.29561 17.7901 6.99852C17.6519 6.70143 17.4505 6.43811 17.2 6.22695L10.45 0.532953Z"
                            fill="currentColor"
                        />
                    </svg>
                    <span className="font-open-sans text-[10px] font-bold leading-[14px] tracking-[0.25px] text-center mt-1">
                        Beranda
                    </span>
                </Link>
                <Link
                    href="/schedule"
                    className={`flex flex-col items-center ${
                        pathname === "/schedule" ? "text-primary" : "text-black"
                    } hover:text-primary`}
                >
                    <svg
                        width="18"
                        height="18"
                        viewBox="0 0 18 18"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M14.75 0C15.612 0 16.4386 0.34241 17.0481 0.951903C17.6576 1.5614 18 2.38805 18 3.25V14.75C18 15.612 17.6576 16.4386 17.0481 17.0481C16.4386 17.6576 15.612 18 14.75 18H3.25C2.38805 18 1.5614 17.6576 0.951903 17.0481C0.34241 16.4386 0 15.612 0 14.75V3.25C0 2.38805 0.34241 1.5614 0.951903 0.951903C1.5614 0.34241 2.38805 0 3.25 0H14.75ZM16.5 5.5H1.5V14.75C1.5 15.716 2.284 16.5 3.25 16.5H14.75C15.2141 16.5 15.6592 16.3156 15.9874 15.9874C16.3156 15.6592 16.5 15.2141 16.5 14.75V5.5ZM4.75 11.5C5.08152 11.5 5.39946 11.6317 5.63388 11.8661C5.8683 12.1005 6 12.4185 6 12.75C6 13.0815 5.8683 13.3995 5.63388 13.6339C5.39946 13.8683 5.08152 14 4.75 14C4.41848 14 4.10054 13.8683 3.86612 13.6339C3.6317 13.3995 3.5 13.0815 3.5 12.75C3.5 12.4185 3.6317 12.1005 3.86612 11.8661C4.10054 11.6317 4.41848 11.5 4.75 11.5ZM9 11.5C9.33152 11.5 9.64946 11.6317 9.88388 11.8661C10.1183 12.1005 10.25 12.4185 10.25 12.75C10.25 13.0815 10.1183 13.3995 9.88388 13.6339C9.64946 13.8683 9.33152 14 9 14C8.66848 14 8.35054 13.8683 8.11612 13.6339C7.8817 13.3995 7.75 13.0815 7.75 12.75C7.75 12.4185 7.8817 12.1005 8.11612 11.8661C8.35054 11.6317 8.66848 11.5 9 11.5ZM4.75 7.5C5.08152 7.5 5.39946 7.6317 5.63388 7.86612C5.8683 8.10054 6 8.41848 6 8.75C6 9.08152 5.8683 9.39946 5.63388 9.63388C5.39946 9.8683 5.08152 10 4.75 10C4.41848 10 4.10054 9.8683 3.86612 9.63388C3.6317 9.39946 3.5 9.08152 3.5 8.75C3.5 8.41848 3.6317 8.10054 3.86612 7.86612C4.10054 7.6317 4.41848 7.5 4.75 7.5ZM9 7.5C9.33152 7.5 9.64946 7.6317 9.88388 7.86612C10.1183 8.10054 10.25 8.41848 10.25 8.75C10.25 9.08152 10.1183 9.39946 9.88388 9.63388C9.64946 9.8683 9.33152 10 9 10C8.66848 10 8.35054 9.8683 8.11612 9.63388C7.8817 9.39946 7.75 9.08152 7.75 8.75C7.75 8.41848 7.8817 8.10054 8.11612 7.86612C8.35054 7.6317 8.66848 7.5 9 7.5ZM13.25 7.5C13.5815 7.5 13.8995 7.6317 14.1339 7.86612C14.3683 8.10054 14.5 8.41848 14.5 8.75C14.5 9.08152 14.3683 9.39946 14.1339 9.63388C13.8995 9.8683 13.5815 10 13.25 10C12.9185 10 12.6005 9.8683 12.3661 9.63388C12.1317 9.39946 12 9.08152 12 8.75C12 8.41848 12.1317 8.10054 12.3661 7.86612C12.6005 7.6317 12.9185 7.5 13.25 7.5ZM14.75 1.5H3.25C2.78587 1.5 2.34075 1.68437 2.01256 2.01256C1.68437 2.34075 1.5 2.78587 1.5 3.25V4H16.5V3.25C16.5 2.78587 16.3156 2.34075 15.9874 2.01256C15.6592 1.68437 15.2141 1.5 14.75 1.5Z"
                            fill="black"
                        />
                    </svg>
                    <span className="font-open-sans text-[10px] font-bold leading-[14px] tracking-[0.25px] text-center mt-1">
                        Jadwal
                    </span>
                </Link>
                <button
                    onClick={handleMedicalRecordClick}
                    className={`flex flex-col items-center ${
                        pathname === "/medical-record"
                            ? "text-primary"
                            : "text-black"
                    } hover:text-primary`}
                >
                    <svg
                        width="25"
                        height="24"
                        viewBox="0 0 25 24"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M4.16669 6.25V8H8.79569C8.99453 7.99983 9.18517 7.92069 9.32569 7.78L10.8557 6.25L9.32569 4.72C9.18517 4.57931 8.99453 4.50017 8.79569 4.5H5.91669C5.45256 4.5 5.00744 4.68437 4.67925 5.01256C4.35106 5.34075 4.16669 5.78587 4.16669 6.25ZM2.66669 6.25C2.66669 5.38805 3.0091 4.5614 3.61859 3.9519C4.22808 3.34241 5.05473 3 5.91669 3H8.79569C9.39208 3.00026 9.96397 3.23729 10.3857 3.659L12.2287 5.5H19.4177C20.2795 5.50027 21.1059 5.84279 21.7151 6.45226C22.3244 7.06172 22.6667 7.88822 22.6667 8.75V13.5C22.2339 13.1754 21.7076 13 21.1667 13V8.75C21.1667 8.28587 20.9823 7.84075 20.6541 7.51256C20.3259 7.18437 19.8808 7 19.4167 7H12.2267L10.3867 8.841C10.1778 9.04993 9.92971 9.21566 9.65673 9.32874C9.38374 9.44181 9.09116 9.5 8.79569 9.5H4.16669V17.75C4.16669 18.716 4.95069 19.5 5.91669 19.5H11.7077C11.681 19.6633 11.6674 19.83 11.6667 20C11.6667 20.328 11.7027 20.666 11.7827 21H5.91669C5.05473 21 4.22808 20.6576 3.61859 20.0481C3.0091 19.4386 2.66669 18.612 2.66669 17.75V6.25ZM16.1667 17C16.6971 17 17.2058 16.7893 17.5809 16.4142C17.956 16.0391 18.1667 15.5304 18.1667 15C18.1667 14.4696 17.956 13.9609 17.5809 13.5858C17.2058 13.2107 16.6971 13 16.1667 13C15.6363 13 15.1275 13.2107 14.7525 13.5858C14.3774 13.9609 14.1667 14.4696 14.1667 15C14.1667 15.5304 14.3774 16.0391 14.7525 16.4142C15.1275 16.7893 15.6363 17 16.1667 17ZM16.1667 23C18.7337 23 19.6667 21.48 19.6667 20C19.6667 19.4696 19.456 18.9609 19.0809 18.5858C18.7058 18.2107 18.1971 18 17.6667 18H14.6667C14.1363 18 13.6275 18.2107 13.2525 18.5858C12.8774 18.9609 12.6667 19.4696 12.6667 20C12.6667 21.48 13.5997 23 16.1667 23ZM20.1737 21.978C20.3297 21.992 20.494 21.9993 20.6667 22C22.8667 22 23.6667 20.784 23.6667 19.6C23.6667 19.1757 23.4981 18.7687 23.1981 18.4686C22.898 18.1686 22.491 18 22.0667 18H19.9027C20.3777 18.53 20.6667 19.232 20.6667 20C20.6667 20.656 20.5227 21.35 20.1737 21.978ZM22.6667 15.5C22.6667 15.8978 22.5087 16.2794 22.2273 16.5607C21.946 16.842 21.5645 17 21.1667 17C20.7689 17 20.3873 16.842 20.106 16.5607C19.8247 16.2794 19.6667 15.8978 19.6667 15.5C19.6667 15.1022 19.8247 14.7206 20.106 14.4393C20.3873 14.158 20.7689 14 21.1667 14C21.5645 14 21.946 14.158 22.2273 14.4393C22.5087 14.7206 22.6667 15.1022 22.6667 15.5Z"
                            fill="black"
                        />
                    </svg>

                    <span className="font-open-sans text-[10px] font-bold leading-[14px] tracking-[0.25px] text-center mt-1">
                        Medical Record
                    </span>
                </button>
            </div>

            {/* Updated PinModal with onSubmit prop */}
            <PinModal
                isOpen={isPinModalOpen}
                onClose={() => setIsPinModalOpen(false)}
                onSubmit={handlePinSubmit}
            />
        </>
    );
};

export default Footer;
